----------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/jdmic/git/solar_stove/data/logs/raw_cleaning_lm.log
  log type:  text
 opened on:   1 Oct 2025, 12:49:34

. 
.         
. * load .csv and save as stata .dta
.         import delimited        "$root/fuel_consumption.csv", clear
(encoding automatically selected: UTF-8)
(27 vars, 936 obs)

. 
. 
. ************************************************************************
. **# 1 - rename and relabel fuel variables
. ************************************************************************
. 
. * drop unnecessary variables / anonymize
.         drop                            household_name name_collected ///
>                                                         name_whopayed type_lozi v27

. 
.         rename                          cod hhid        

.                 
.         gen                             Village = 0 if village == "Lealui" | ///
>                                                         village == "LeaLui" | village == "lealui"
(644 missing values generated)

.         replace                         Village = 1 if village == "Mapungu"
(250 real changes made)

.         replace                         Village = 2 if village == "Nalitoya"
(394 real changes made)

.         lab var                         Village "Village"

.         lab def                         village 0 "Lealui" 1 "Mapungu" 2 "Nalitoya"

.         lab val                         Village village

.         
.         drop                            village

.         rename                          Village village

.         order                           village         

.                                                 
.         drop if                         hhid == .
(0 observations deleted)

. 
. * rename and redefine variables 
.         gen                                     fuel = 0 if type_en == "Charcoal"
(827 missing values generated)

.         replace                         fuel = 1 if type_en == "Firewood/Caw dong" | ///
>                                                         type_en == "Firewood"
(800 real changes made)

.         replace                         fuel = 0 if type_en == "undefined" & bought == 1                            
>             
(18 real changes made)

.         
.         lab define                      fuel 0 "Charcoal" 1 "Firewood"

.         lab values                      fuel fuel

.         order                           fuel, after(week)

.         lab var                         fuel "Type of fuel"

.         drop                            type_en

.         drop if                         fuel == .
(9 observations deleted)

. 
.         rename                          collected cltd

.         lab define                      yesno 0 "No" 1 "Yes"

.         lab values                      cltd yesno 

.         
.         rename                          time_collection_min time_cltd

.         replace                         time_cltd = 0 if time_cltd == .
(232 real changes made)

.         
.         rename                          price_collected_kwacha price_cltd

.                 
.         rename                          q_collected_kg quant_cltd

.         replace                         quant_cltd = 0 if quant_cltd == .
(130 real changes made)

.                 
.         replace                         times_collected_week = "" if times_collected_week == "-"
(1 real change made)

.         destring                        times_collected_week, replace
times_collected_week: all characters numeric; replaced as byte
(138 missing values generated)

.         rename                          times_collected_week times_cltd

.         replace                         times_cltd = 0 if times_cltd == .
(138 real changes made)

. 
.         rename                          bought bght

.         lab values                      bght yesno 

.         
.         rename                          time_bought_week times_bght

.         replace                         times_bght = 0 if times_bght == .
(538 real changes made)

.         
.         rename                          price_bought_kwacha price_bght

.         
.         rename                          q_bought_kg quant_bght

.         replace                         quant_bght = 0 if quant_bght == .
(536 real changes made)

.         
.         drop                            source_or_price_written_collecti time_collection_week ///
>                                                         quantity_collected_written quantity_collected_clean ///
>                                                         units_clean source_or_price_written_bought ///
>                                                         quantity_written_bought

.         
.         order                           cltd times_cltd time_cltd price_cltd quant_cltd ///
>                                                         bght times_bght price_bght quant_bght, ///
>                                                         after(fuel)

.         
.         replace                         cod_hh_collectedbought = "" if cod_hh_collectedbought == "Missing name "
(50 real changes made)

.         replace                         cod_hh_bought = "" if cod_hh_bought == "Missing name "
(67 real changes made)

. 
.         destring                        cod_hh_collectedbought, replace
cod_hh_collectedbought: all characters numeric; replaced as long
(172 missing values generated)

.         destring                        cod_hh_bought, replace
cod_hh_bought: all characters numeric; replaced as long
(601 missing values generated)

.         
.         
. * collapse to combine firewood and firewood/dung
.         collapse (sum)          times_cltd time_cltd price_cltd quant_cltd times_bght ///
>                                                 price_bght quant_bght ///
>                          (max)          cltd bght, by(village hhid week cod_hh_collectedbought cod_hh_bought)

. 
. 
.         replace                         price_cltd = . if price_cltd == 0
(810 real changes made, 810 to missing)

.         replace                         price_bght = . if price_bght == 0
(885 real changes made, 885 to missing)

.         
. * save individual
.         compress
  variable village was float now byte
  variable times_cltd was double now byte
  variable time_cltd was double now int
  variable price_cltd was double now byte
  variable times_bght was double now byte
  variable price_bght was double now byte
  (33,596 bytes saved)

.         save                            "$export/fuel_cleaned_ind.dta", replace
(file C:/Users/jdmic/git/solar_stove/data/refined/fuel_cleaned_ind.dta not found)
file C:/Users/jdmic/git/solar_stove/data/refined/fuel_cleaned_ind.dta saved

. 
. 
. * collapse to combine firewood and firewood/dung
.         collapse (sum)          times_cltd time_cltd price_cltd quant_cltd times_bght ///
>                                                 price_bght quant_bght ///
>                          (max)          cltd bght, by(village hhid week)

.                          
.         replace                         price_cltd = . if price_cltd == 0
(794 real changes made, 794 to missing)

.         replace                         price_bght = . if price_bght == 0
(869 real changes made, 869 to missing)

. 
. * rename variables              
.         replace                         bght = 0 if bght == .
(0 real changes made)

.         rename                          bght charcoal   

.         lab var                         charcoal "Was charcoal bought?" 

.         
.         replace                         times_bght = 0 if times_bght == .
(0 real changes made)

.         rename                          times_bght c_times      

.         lab var                         c_times "Number of times charcoal was bought"   

.         
.         rename                          price_bght c_price

.         lab var                         c_price "Price of charcoal (kwacha)"    

.         
.         replace                         quant_bght = 0 if quant_bght == .
(0 real changes made)

.         rename                          quant_bght c_quant

.         lab var                         c_quant "Quantity of charcoal (kg)"

.                 
.         replace                         cltd = 0 if cltd == .
(0 real changes made)

.         rename                          cltd firewood

.         lab var                         firewood "Was firewood collected?"      

.         
.         replace                         times_cltd = 0 if times_cltd == .
(0 real changes made)

.         rename                          times_cltd f_times      

.         lab var                         f_times "Number of times firewood was collected"        

.         
.         replace                         time_cltd = 0 if time_cltd == .
(0 real changes made)

.         rename                          time_cltd f_time

.         lab var                         f_time "Time spent collecting firewood (min)"           

.         
.         rename                          price_cltd f_price

.         lab var                         f_price "Price of firewood collected (kwacha)"  

.         
.         replace                         quant_cltd = 0 if quant_cltd == .
(0 real changes made)

.         rename                          quant_cltd f_quant

.         lab var                         f_quant "Quantity of firewood collected (kg)"

.         
. * drop household that collected for 9 weeks
.         drop if                         week > 6
(4 observations deleted)

. 
. * natalia uses a price of $0.12 for charcoal and $0.13 for firewood
. * replace price with these values
.         replace                         c_price = 0.12
(888 real changes made)

.         replace                         f_price = 0.13
(888 real changes made)

.         lab var                         f_price "Price of firewood (USD)"

.         lab var                         c_price "Price of charcoal (USD)"       

. 
. * generate upper and lower bound values 
.         gen                                     f_quant_lb = f_quant

.         gen                                     f_quant_ub = f_times*f_quant    

.         lab var                         f_quant_lb "Quantity of firewood lower bound (kg)"

.         lab var                         f_quant_ub "Quantity of firewood upper bound (kg)"

.         
.         gen                                     f_val_lb = f_price*f_quant_lb

.         gen                                     f_val_ub = f_price*f_quant_ub

.         lab var                         f_val_lb "Value of firewood lower bound (USD)"

.         lab var                         f_val_ub "Value of firewood upper bound (USD)"

.         
.         gen                                     c_quant_lb = c_quant

.         gen                                     c_quant_ub = c_times*c_quant

.         lab var                         c_quant_lb "Quantity of charcoal lower bound (kg)"

.         lab var                         c_quant_ub "Quantity of charcoal upper bound (kg)"

.         
.         gen                                     c_val_lb = c_price*c_quant_lb

.         gen                                     c_val_ub = c_price*c_quant_ub

.         lab var                         c_val_lb "Value of charcoal lower bound (USD)"

.         lab var                         c_val_ub "Value of charcoal upper bound (USD)"

.         
.         gen                                     val_fuel_lb = f_val_lb + c_val_lb

.         gen                                     val_fuel_ub = f_val_ub + c_val_ub

.         lab var                         val_fuel_lb "Value of all fuel lower bound (USD)"

.         lab var                         val_fuel_ub "Value of all fuel upper bound (USD)"

.         
. 
. ************************************************************************
. **# 2 - add control variables
. ************************************************************************
. 
. * add cloud cover data
.         gen                     cc = 100 if week == 1 & village == 1
(850 missing values generated)

.         replace                 cc = 11.75 if week == 2 & village == 1
(36 real changes made)

.         replace                 cc= 99.99 if week == 3 & village == 1
(36 real changes made)

.         replace                 cc = 0.00 if week == 4 & village == 1
(38 real changes made)

.         replace                 cc = 0.00 if week == 5 & village == 1
(37 real changes made)

.         replace                 cc = 0.00 if week == 6 & village == 1
(36 real changes made)

.         replace                 cc = 100 if week == 1 & village == 0
(54 real changes made)

.         replace                 cc = 1.7 if week == 2 & village == 0
(47 real changes made)

.         replace                 cc = 2.06 if week == 3 & village == 0
(50 real changes made)

.         replace                 cc = 0 if week == 4 & village == 0
(46 real changes made)

.         replace                 cc = 0 if week == 5 & village == 0
(48 real changes made)

.         replace                 cc = 0.01 if week == 6 & village == 0
(43 real changes made)

.         replace                 cc = 100 if week == 1 & village == 2
(64 real changes made)

.         replace                 cc = 35.84 if week == 2 & village == 2
(60 real changes made)

.         replace                 cc = 0 if week == 3 & village == 2
(64 real changes made)

.         replace                 cc = 0 if week == 4 & village == 2
(64 real changes made)

.         replace                 cc = 0 if week == 5 & village == 2
(63 real changes made)

.         replace                 cc = 0 if week == 6 & village == 2
(64 real changes made)

.                 
.         lab var                 cc "Cloud Cover"        

. 
. * merge in household characteristics
.         drop                            village

.         merge                           m:1 hhid using "$export/c_var.dta"
(label village already defined)

    Result                      Number of obs
    -----------------------------------------
    Not matched                            18
        from master                        18  (_merge==1)
        from using                          0  (_merge==2)

    Matched                               870  (_merge==3)
    -----------------------------------------

.         *** 3 households have fuel data but not household data
.         *** hhid 247000, 340000, 347000
.         
.         keep if                         _merge == 3
(18 observations deleted)

.         drop                            _merge

.         
. * save
.         compress
  variable c_quant_ub was float now int
  variable f_times was double now byte
  variable f_time was double now int
  variable c_times was double now byte
  (19,140 bytes saved)

.         save                            "$export/fuel_cleaned.dta", replace
(file C:/Users/jdmic/git/solar_stove/data/refined/fuel_cleaned.dta not found)
file C:/Users/jdmic/git/solar_stove/data/refined/fuel_cleaned.dta saved

. 
. * close the log
.         log     close
      name:  <unnamed>
       log:  C:/Users/jdmic/git/solar_stove/data/logs/raw_cleaning_lm.log
  log type:  text
 closed on:   1 Oct 2025, 12:49:34
----------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/jdmic/git/solar_stove/data/logs/raw_cleaning_lm.log
  log type:  text
 opened on:   1 Oct 2025, 13:01:26

. 
.         
. * load .csv and save as stata .dta
.         import delimited        "$root/fuel_consumption.csv", clear
(encoding automatically selected: UTF-8)
(27 vars, 936 obs)

. 
. 
. ************************************************************************
. **# 1 - rename and relabel fuel variables
. ************************************************************************
. 
. * drop unnecessary variables / anonymize
.         drop                            household_name name_collected ///
>                                                         name_whopayed type_lozi v27

. 
.         rename                          cod hhid        

.                 
.         gen                             Village = 0 if village == "Lealui" | ///
>                                                         village == "LeaLui" | village == "lealui"
(644 missing values generated)

.         replace                         Village = 1 if village == "Mapungu"
(250 real changes made)

.         replace                         Village = 2 if village == "Nalitoya"
(394 real changes made)

.         lab var                         Village "Village"

.         lab def                         village 0 "Lealui" 1 "Mapungu" 2 "Nalitoya"

.         lab val                         Village village

.         
.         drop                            village

.         rename                          Village village

.         order                           village         

.                                                 
.         drop if                         hhid == .
(0 observations deleted)

. 
. * rename and redefine variables 
.         gen                                     fuel = 0 if type_en == "Charcoal"
(827 missing values generated)

.         replace                         fuel = 1 if type_en == "Firewood/Caw dong" | ///
>                                                         type_en == "Firewood"
(800 real changes made)

.         replace                         fuel = 0 if type_en == "undefined" & bought == 1                            
>             
(18 real changes made)

.         
.         lab define                      fuel 0 "Charcoal" 1 "Firewood"

.         lab values                      fuel fuel

.         order                           fuel, after(week)

.         lab var                         fuel "Type of fuel"

.         drop                            type_en

.         drop if                         fuel == .
(9 observations deleted)

. 
.         rename                          collected cltd

.         lab define                      yesno 0 "No" 1 "Yes"

.         lab values                      cltd yesno 

.         
.         rename                          time_collection_min time_cltd

.         replace                         time_cltd = 0 if time_cltd == .
(232 real changes made)

.         
.         rename                          price_collected_kwacha price_cltd

.                 
.         rename                          q_collected_kg quant_cltd

.         replace                         quant_cltd = 0 if quant_cltd == .
(130 real changes made)

.                 
.         replace                         times_collected_week = "" if times_collected_week == "-"
(1 real change made)

.         destring                        times_collected_week, replace
times_collected_week: all characters numeric; replaced as byte
(138 missing values generated)

.         rename                          times_collected_week times_cltd

.         replace                         times_cltd = 0 if times_cltd == .
(138 real changes made)

. 
.         rename                          bought bght

.         lab values                      bght yesno 

.         
.         rename                          time_bought_week times_bght

.         replace                         times_bght = 0 if times_bght == .
(538 real changes made)

.         
.         rename                          price_bought_kwacha price_bght

.         
.         rename                          q_bought_kg quant_bght

.         replace                         quant_bght = 0 if quant_bght == .
(536 real changes made)

.         
.         drop                            source_or_price_written_collecti time_collection_week ///
>                                                         quantity_collected_written quantity_collected_clean ///
>                                                         units_clean source_or_price_written_bought ///
>                                                         quantity_written_bought

.         
.         order                           cltd times_cltd time_cltd price_cltd quant_cltd ///
>                                                         bght times_bght price_bght quant_bght, ///
>                                                         after(fuel)

.         
.         replace                         cod_hh_collectedbought = "" if cod_hh_collectedbought == "Missing name "
(50 real changes made)

.         replace                         cod_hh_bought = "" if cod_hh_bought == "Missing name "
(67 real changes made)

. 
.         destring                        cod_hh_collectedbought, replace
cod_hh_collectedbought: all characters numeric; replaced as long
(172 missing values generated)

.         destring                        cod_hh_bought, replace
cod_hh_bought: all characters numeric; replaced as long
(601 missing values generated)

.         
.         
. * collapse to combine firewood and firewood/dung
.         collapse (sum)          times_cltd time_cltd price_cltd quant_cltd times_bght ///
>                                                 price_bght quant_bght ///
>                          (max)          cltd bght, by(village hhid week cod_hh_collectedbought cod_hh_bought)

. 
. 
.         replace                         price_cltd = . if price_cltd == 0
(810 real changes made, 810 to missing)

.         replace                         price_bght = . if price_bght == 0
(885 real changes made, 885 to missing)

.         
. * save individual
.         compress
  variable village was float now byte
  variable times_cltd was double now byte
  variable time_cltd was double now int
  variable price_cltd was double now byte
  variable times_bght was double now byte
  variable price_bght was double now byte
  (33,596 bytes saved)

.         save                            "$export/fuel_cleaned_ind.dta", replace
file C:/Users/jdmic/git/solar_stove/data/refined/fuel_cleaned_ind.dta saved

. 
. 
. * collapse to combine firewood and firewood/dung
.         collapse (sum)          times_cltd time_cltd price_cltd quant_cltd times_bght ///
>                                                 price_bght quant_bght ///
>                          (max)          cltd bght, by(village hhid week)

.                          
.         replace                         price_cltd = . if price_cltd == 0
(794 real changes made, 794 to missing)

.         replace                         price_bght = . if price_bght == 0
(869 real changes made, 869 to missing)

. 
. * rename variables              
.         replace                         bght = 0 if bght == .
(0 real changes made)

.         rename                          bght charcoal   

.         lab var                         charcoal "Was charcoal bought?" 

.         
.         replace                         times_bght = 0 if times_bght == .
(0 real changes made)

.         rename                          times_bght c_times      

.         lab var                         c_times "Number of times charcoal was bought"   

.         
.         rename                          price_bght c_price

.         lab var                         c_price "Price of charcoal (kwacha)"    

.         
.         replace                         quant_bght = 0 if quant_bght == .
(0 real changes made)

.         rename                          quant_bght c_quant

.         lab var                         c_quant "Quantity of charcoal (kg)"

.                 
.         replace                         cltd = 0 if cltd == .
(0 real changes made)

.         rename                          cltd firewood

.         lab var                         firewood "Was firewood collected?"      

.         
.         replace                         times_cltd = 0 if times_cltd == .
(0 real changes made)

.         rename                          times_cltd f_times      

.         lab var                         f_times "Number of times firewood was collected"        

.         
.         replace                         time_cltd = 0 if time_cltd == .
(0 real changes made)

.         rename                          time_cltd f_time

.         lab var                         f_time "Time spent collecting firewood (min)"           

.         
.         rename                          price_cltd f_price

.         lab var                         f_price "Price of firewood collected (kwacha)"  

.         
.         replace                         quant_cltd = 0 if quant_cltd == .
(0 real changes made)

.         rename                          quant_cltd f_quant

.         lab var                         f_quant "Quantity of firewood collected (kg)"

.         
. * drop household that collected for 9 weeks
.         drop if                         week > 6
(4 observations deleted)

. 
. * natalia uses a price of $0.12 for charcoal and $0.13 for firewood
. * replace price with these values
.         replace                         c_price = 0.12
(888 real changes made)

.         replace                         f_price = 0.13
(888 real changes made)

.         lab var                         f_price "Price of firewood (USD)"

.         lab var                         c_price "Price of charcoal (USD)"       

. 
. * generate upper and lower bound values 
.         gen                                     f_quant_lb = f_quant

.         gen                                     f_quant_ub = f_times*f_quant    

.         lab var                         f_quant_lb "Quantity of firewood lower bound (kg)"

.         lab var                         f_quant_ub "Quantity of firewood upper bound (kg)"

.         
.         gen                                     f_val_lb = f_price*f_quant_lb

.         gen                                     f_val_ub = f_price*f_quant_ub

.         lab var                         f_val_lb "Value of firewood lower bound (USD)"

.         lab var                         f_val_ub "Value of firewood upper bound (USD)"

.         
.         gen                                     c_quant_lb = c_quant

.         gen                                     c_quant_ub = c_times*c_quant

.         lab var                         c_quant_lb "Quantity of charcoal lower bound (kg)"

.         lab var                         c_quant_ub "Quantity of charcoal upper bound (kg)"

.         
.         gen                                     c_val_lb = c_price*c_quant_lb

.         gen                                     c_val_ub = c_price*c_quant_ub

.         lab var                         c_val_lb "Value of charcoal lower bound (USD)"

.         lab var                         c_val_ub "Value of charcoal upper bound (USD)"

.         
.         gen                                     val_fuel_lb = f_val_lb + c_val_lb

.         gen                                     val_fuel_ub = f_val_ub + c_val_ub

.         lab var                         val_fuel_lb "Value of all fuel lower bound (USD)"

.         lab var                         val_fuel_ub "Value of all fuel upper bound (USD)"

.         
. 
. ************************************************************************
. **# 2 - add control variables
. ************************************************************************
. 
. * add cloud cover data
.         gen                     cc = 100 if week == 1 & village == 1
(850 missing values generated)

.         replace                 cc = 11.75 if week == 2 & village == 1
(36 real changes made)

.         replace                 cc= 99.99 if week == 3 & village == 1
(36 real changes made)

.         replace                 cc = 0.00 if week == 4 & village == 1
(38 real changes made)

.         replace                 cc = 0.00 if week == 5 & village == 1
(37 real changes made)

.         replace                 cc = 0.00 if week == 6 & village == 1
(36 real changes made)

.         replace                 cc = 100 if week == 1 & village == 0
(54 real changes made)

.         replace                 cc = 1.7 if week == 2 & village == 0
(47 real changes made)

.         replace                 cc = 2.06 if week == 3 & village == 0
(50 real changes made)

.         replace                 cc = 0 if week == 4 & village == 0
(46 real changes made)

.         replace                 cc = 0 if week == 5 & village == 0
(48 real changes made)

.         replace                 cc = 0.01 if week == 6 & village == 0
(43 real changes made)

.         replace                 cc = 100 if week == 1 & village == 2
(64 real changes made)

.         replace                 cc = 35.84 if week == 2 & village == 2
(60 real changes made)

.         replace                 cc = 0 if week == 3 & village == 2
(64 real changes made)

.         replace                 cc = 0 if week == 4 & village == 2
(64 real changes made)

.         replace                 cc = 0 if week == 5 & village == 2
(63 real changes made)

.         replace                 cc = 0 if week == 6 & village == 2
(64 real changes made)

.                 
.         lab var                 cc "Cloud Cover"        

. 
. * merge in household characteristics
.         drop                            village

.         merge                           m:1 hhid using "$export/c_var.dta"
(label village already defined)

    Result                      Number of obs
    -----------------------------------------
    Not matched                            18
        from master                        18  (_merge==1)
        from using                          0  (_merge==2)

    Matched                               870  (_merge==3)
    -----------------------------------------

.         *** 3 households have fuel data but not household data
.         *** hhid 247000, 340000, 347000
.         
.         keep if                         _merge == 3
(18 observations deleted)

.         drop                            _merge

.         
. * save
.         compress
  variable c_quant_ub was float now int
  variable f_times was double now byte
  variable f_time was double now int
  variable c_times was double now byte
  (19,140 bytes saved)

.         save                            "$export/fuel_cleaned.dta", replace
file C:/Users/jdmic/git/solar_stove/data/refined/fuel_cleaned.dta saved

. 
. * close the log
.         log     close
      name:  <unnamed>
       log:  C:/Users/jdmic/git/solar_stove/data/logs/raw_cleaning_lm.log
  log type:  text
 closed on:   1 Oct 2025, 13:01:26
----------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/jdmic/git/solar_stove/data/logs/raw_cleaning_lm.log
  log type:  text
 opened on:   1 Oct 2025, 13:02:50

. 
.         
. * load .csv and save as stata .dta
.         import delimited        "$root/fuel_consumption.csv", clear
(encoding automatically selected: UTF-8)
(27 vars, 936 obs)

. 
. 
. ************************************************************************
. **# 1 - rename and relabel fuel variables
. ************************************************************************
. 
. * drop unnecessary variables / anonymize
.         drop                            household_name name_collected ///
>                                                         name_whopayed type_lozi v27

. 
.         rename                          cod hhid        

.                 
.         gen                             Village = 0 if village == "Lealui" | ///
>                                                         village == "LeaLui" | village == "lealui"
(644 missing values generated)

.         replace                         Village = 1 if village == "Mapungu"
(250 real changes made)

.         replace                         Village = 2 if village == "Nalitoya"
(394 real changes made)

.         lab var                         Village "Village"

.         lab def                         village 0 "Lealui" 1 "Mapungu" 2 "Nalitoya"

.         lab val                         Village village

.         
.         drop                            village

.         rename                          Village village

.         order                           village         

.                                                 
.         drop if                         hhid == .
(0 observations deleted)

. 
. * rename and redefine variables 
.         gen                                     fuel = 0 if type_en == "Charcoal"
(827 missing values generated)

.         replace                         fuel = 1 if type_en == "Firewood/Caw dong" | ///
>                                                         type_en == "Firewood"
(800 real changes made)

.         replace                         fuel = 0 if type_en == "undefined" & bought == 1                            
>             
(18 real changes made)

.         
.         lab define                      fuel 0 "Charcoal" 1 "Firewood"

.         lab values                      fuel fuel

.         order                           fuel, after(week)

.         lab var                         fuel "Type of fuel"

.         drop                            type_en

.         drop if                         fuel == .
(9 observations deleted)

. 
.         rename                          collected cltd

.         lab define                      yesno 0 "No" 1 "Yes"

.         lab values                      cltd yesno 

.         
.         rename                          time_collection_min time_cltd

.         replace                         time_cltd = 0 if time_cltd == .
(232 real changes made)

.         
.         rename                          price_collected_kwacha price_cltd

.                 
.         rename                          q_collected_kg quant_cltd

.         replace                         quant_cltd = 0 if quant_cltd == .
(130 real changes made)

.                 
.         replace                         times_collected_week = "" if times_collected_week == "-"
(1 real change made)

.         destring                        times_collected_week, replace
times_collected_week: all characters numeric; replaced as byte
(138 missing values generated)

.         rename                          times_collected_week times_cltd

.         replace                         times_cltd = 0 if times_cltd == .
(138 real changes made)

. 
.         rename                          bought bght

.         lab values                      bght yesno 

.         
.         rename                          time_bought_week times_bght

.         replace                         times_bght = 0 if times_bght == .
(538 real changes made)

.         
.         rename                          price_bought_kwacha price_bght

.         
.         rename                          q_bought_kg quant_bght

.         replace                         quant_bght = 0 if quant_bght == .
(536 real changes made)

.         
.         drop                            source_or_price_written_collecti time_collection_week ///
>                                                         quantity_collected_written quantity_collected_clean ///
>                                                         units_clean source_or_price_written_bought ///
>                                                         quantity_written_bought

.         
.         order                           cltd times_cltd time_cltd price_cltd quant_cltd ///
>                                                         bght times_bght price_bght quant_bght, ///
>                                                         after(fuel)

.         
.         replace                         cod_hh_collectedbought = "" if cod_hh_collectedbought == "Missing name "
(50 real changes made)

.         replace                         cod_hh_bought = "" if cod_hh_bought == "Missing name "
(67 real changes made)

. 
.         destring                        cod_hh_collectedbought, replace
cod_hh_collectedbought: all characters numeric; replaced as long
(172 missing values generated)

.         destring                        cod_hh_bought, replace
cod_hh_bought: all characters numeric; replaced as long
(601 missing values generated)

.         
.         
. * collapse to combine firewood and firewood/dung
.         collapse (sum)          times_cltd time_cltd price_cltd quant_cltd times_bght ///
>                                                 price_bght quant_bght ///
>                          (max)          cltd bght, by(village hhid week cod_hh_collectedbought cod_hh_bought)

. 
. 
.         replace                         price_cltd = . if price_cltd == 0
(810 real changes made, 810 to missing)

.         replace                         price_bght = . if price_bght == 0
(885 real changes made, 885 to missing)

.         
. * save individual
.         compress
  variable village was float now byte
  variable times_cltd was double now byte
  variable time_cltd was double now int
  variable price_cltd was double now byte
  variable times_bght was double now byte
  variable price_bght was double now byte
  (33,596 bytes saved)

.         save                            "$export/fuel_cleaned_ind.dta", replace
file C:/Users/jdmic/git/solar_stove/data/refined/fuel_cleaned_ind.dta saved

. 
. 
. * collapse to combine firewood and firewood/dung
.         collapse (sum)          times_cltd time_cltd price_cltd quant_cltd times_bght ///
>                                                 price_bght quant_bght ///
>                          (max)          cltd bght, by(village hhid week)

.                          
.         replace                         price_cltd = . if price_cltd == 0
(794 real changes made, 794 to missing)

.         replace                         price_bght = . if price_bght == 0
(869 real changes made, 869 to missing)

. 
. * rename variables              
.         replace                         bght = 0 if bght == .
(0 real changes made)

.         rename                          bght charcoal   

.         lab var                         charcoal "Was charcoal bought?" 

.         
.         replace                         times_bght = 0 if times_bght == .
(0 real changes made)

.         rename                          times_bght c_times      

.         lab var                         c_times "Number of times charcoal was bought"   

.         
.         rename                          price_bght c_price

.         lab var                         c_price "Price of charcoal (kwacha)"    

.         
.         replace                         quant_bght = 0 if quant_bght == .
(0 real changes made)

.         rename                          quant_bght c_quant

.         lab var                         c_quant "Quantity of charcoal (kg)"

.                 
.         replace                         cltd = 0 if cltd == .
(0 real changes made)

.         rename                          cltd firewood

.         lab var                         firewood "Was firewood collected?"      

.         
.         replace                         times_cltd = 0 if times_cltd == .
(0 real changes made)

.         rename                          times_cltd f_times      

.         lab var                         f_times "Number of times firewood was collected"        

.         
.         replace                         time_cltd = 0 if time_cltd == .
(0 real changes made)

.         rename                          time_cltd f_time

.         lab var                         f_time "Time spent collecting firewood (min)"           

.         
.         rename                          price_cltd f_price

.         lab var                         f_price "Price of firewood collected (kwacha)"  

.         
.         replace                         quant_cltd = 0 if quant_cltd == .
(0 real changes made)

.         rename                          quant_cltd f_quant

.         lab var                         f_quant "Quantity of firewood collected (kg)"

.         
. * drop household that collected for 9 weeks
.         drop if                         week > 6
(4 observations deleted)

. 
. * natalia uses a price of $0.12 for charcoal and $0.13 for firewood
. * replace price with these values
.         replace                         c_price = 0.12
(888 real changes made)

.         replace                         f_price = 0.13
(888 real changes made)

.         lab var                         f_price "Price of firewood (USD)"

.         lab var                         c_price "Price of charcoal (USD)"       

. 
. * generate upper and lower bound values 
.         gen                                     f_quant_lb = f_quant

.         gen                                     f_quant_ub = f_times*f_quant    

.         lab var                         f_quant_lb "Quantity of firewood lower bound (kg)"

.         lab var                         f_quant_ub "Quantity of firewood upper bound (kg)"

.         
.         gen                                     f_val_lb = f_price*f_quant_lb

.         gen                                     f_val_ub = f_price*f_quant_ub

.         lab var                         f_val_lb "Value of firewood lower bound (USD)"

.         lab var                         f_val_ub "Value of firewood upper bound (USD)"

.         
.         gen                                     c_quant_lb = c_quant

.         gen                                     c_quant_ub = c_times*c_quant

.         lab var                         c_quant_lb "Quantity of charcoal lower bound (kg)"

.         lab var                         c_quant_ub "Quantity of charcoal upper bound (kg)"

.         
.         gen                                     c_val_lb = c_price*c_quant_lb

.         gen                                     c_val_ub = c_price*c_quant_ub

.         lab var                         c_val_lb "Value of charcoal lower bound (USD)"

.         lab var                         c_val_ub "Value of charcoal upper bound (USD)"

.         
.         gen                                     val_fuel_lb = f_val_lb + c_val_lb

.         gen                                     val_fuel_ub = f_val_ub + c_val_ub

.         lab var                         val_fuel_lb "Value of all fuel lower bound (USD)"

.         lab var                         val_fuel_ub "Value of all fuel upper bound (USD)"

.         
. 
. ************************************************************************
. **# 2 - add control variables
. ************************************************************************
. 
. * add cloud cover data
.         gen                     cc = 100 if week == 1 & village == 1
(850 missing values generated)

.         replace                 cc = 11.75 if week == 2 & village == 1
(36 real changes made)

.         replace                 cc= 99.99 if week == 3 & village == 1
(36 real changes made)

.         replace                 cc = 0.00 if week == 4 & village == 1
(38 real changes made)

.         replace                 cc = 0.00 if week == 5 & village == 1
(37 real changes made)

.         replace                 cc = 0.00 if week == 6 & village == 1
(36 real changes made)

.         replace                 cc = 100 if week == 1 & village == 0
(54 real changes made)

.         replace                 cc = 1.7 if week == 2 & village == 0
(47 real changes made)

.         replace                 cc = 2.06 if week == 3 & village == 0
(50 real changes made)

.         replace                 cc = 0 if week == 4 & village == 0
(46 real changes made)

.         replace                 cc = 0 if week == 5 & village == 0
(48 real changes made)

.         replace                 cc = 0.01 if week == 6 & village == 0
(43 real changes made)

.         replace                 cc = 100 if week == 1 & village == 2
(64 real changes made)

.         replace                 cc = 35.84 if week == 2 & village == 2
(60 real changes made)

.         replace                 cc = 0 if week == 3 & village == 2
(64 real changes made)

.         replace                 cc = 0 if week == 4 & village == 2
(64 real changes made)

.         replace                 cc = 0 if week == 5 & village == 2
(63 real changes made)

.         replace                 cc = 0 if week == 6 & village == 2
(64 real changes made)

.                 
.         lab var                 cc "Cloud Cover"        

. 
. * merge in household characteristics
.         drop                            village

.         merge                           m:1 hhid using "$export/c_var.dta"
(label village already defined)

    Result                      Number of obs
    -----------------------------------------
    Not matched                            18
        from master                        18  (_merge==1)
        from using                          0  (_merge==2)

    Matched                               870  (_merge==3)
    -----------------------------------------

.         *** 3 households have fuel data but not household data
.         *** hhid 247000, 340000, 347000
.         
.         keep if                         _merge == 3
(18 observations deleted)

.         drop                            _merge

.         
. * save
.         compress
  variable c_quant_ub was float now int
  variable f_times was double now byte
  variable f_time was double now int
  variable c_times was double now byte
  (19,140 bytes saved)

.         save                            "$export/fuel_cleaned.dta", replace
file C:/Users/jdmic/git/solar_stove/data/refined/fuel_cleaned.dta saved

. 
. * close the log
.         log     close
      name:  <unnamed>
       log:  C:/Users/jdmic/git/solar_stove/data/logs/raw_cleaning_lm.log
  log type:  text
 closed on:   1 Oct 2025, 13:02:50
----------------------------------------------------------------------------------------------------------------------
